import { DependenciesTreeNode } from '../../treeDataProviders/dependenciesTree/dependenciesTreeNode';
import { IIssueCacheObject } from '../../types/issueCacheObject';
import { IIssueKey } from '../../types/issueKey';
import { ExportableVulnerability } from '../exportable/exportableVulnerability';

export class CsvVulnerabilityRow extends ExportableVulnerability {
    private _severity!: string;
    private _impactedDependencyName!: string;
    private _impactedDependencyVersion!: string;
    private _type!: string;
    private _fixedVersions!: string[];
    private _directDependencies!: string[];
    private _cves!: string[];
    private _issueId!: string;
    private _summary!: string;

    public get severity(): string {
        return this._severity;
    }

    public getSeverity(): string {
        return this._severity;
    }

    public setSeverity(value: string) {
        this._severity = value;
    }

    public get impactedDependencyName(): string {
        return this._impactedDependencyName;
    }

    public setImpactedDependencyName(value: string) {
        this._impactedDependencyName = value;
    }

    public get impactedDependencyVersion(): string {
        return this._impactedDependencyVersion;
    }

    public setImpactedDependencyVersion(value: string) {
        this._impactedDependencyVersion = value;
    }

    public get type(): string {
        return this._type;
    }

    public setType(value: string) {
        this._type = value;
    }

    public get fixedVersions(): string[] {
        return this._fixedVersions;
    }

    public setFixedVersions(value: string[]) {
        this._fixedVersions = value;
    }

    public get directDependencies(): string[] {
        return this._directDependencies;
    }

    public set directDependencies(value: string[]) {
        this._directDependencies = value;
    }

    public setDirectDependencies(value: string[]) {
        this._directDependencies = value;
    }

    public get cves(): string[] {
        return this._cves;
    }

    public setCves(value: string[]) {
        this._cves = value;
    }

    public get issueId(): string {
        return this._issueId;
    }

    public setIssueId(value: string) {
        this._issueId = value;
    }

    public get summary(): string {
        return this._summary;
    }
    
    public setSummary(value: string) {
        this._summary = value;
    }

    constructor(_directDependency: DependenciesTreeNode, _issueKey: IIssueKey, _issue: IIssueCacheObject) {
        super(_directDependency, _issueKey, _issue);
    }

    public addDirectDependency(directDependency: string): void {
        this.directDependencies = this.directDependencies ? this.directDependencies : [];
        this.directDependencies.push(directDependency);
    }
}
