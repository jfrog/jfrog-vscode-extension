import { DependenciesTreeNode } from '../../treeDataProviders/dependenciesTree/dependenciesTreeNode';
import { IIssueCacheObject } from '../../types/issueCacheObject';
import { IIssueKey } from '../../types/issueKey';
import { SeverityUtils } from '../../types/severity';
import { ExportableComponent } from './exportableComponent';

export abstract class ExportableVulnerability extends ExportableComponent {
    constructor(_directDependency: DependenciesTreeNode, _issueKey: IIssueKey, private _issue: IIssueCacheObject) {
        super(_directDependency, _issueKey.component);
        this.setSeverity(SeverityUtils.getString(this._issue.severity));
        this.setFixedVersions(this._issue.fixedVersions);
        this.setCves(this._issue.cves);
        this.setIssueId(this._issue.issueId);
        this.setSummary(this._issue.summary);
    }

    public abstract getSeverity(): string;

    public abstract setSeverity(severity: string): void;

    public abstract setFixedVersions(fixedVersions: string[]): void;

    public abstract setCves(cves: string[]): void;

    public abstract setIssueId(issueId: string): void;

    public abstract setSummary(summary: string): void;
}
